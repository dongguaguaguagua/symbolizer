name: Release

on:
    push:
        tags:
            - "*"

permissions:
    contents: write

jobs:
    release:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4

            - uses: subosito/flutter-action@v2
              with:
                  flutter-version: "3.38.x"

            - name: Build APK
              working-directory: mobile
              run: |
                  flutter pub get
                  flutter build apk --release --split-per-abi

            - name: Create GitHub Release
              uses: softprops/action-gh-release@v2
              with:
                  files: |
                      mobile/build/app/outputs/flutter-apk/app-*-release.apk
